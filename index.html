<!doctype html>
<html>
<head>
    <title>Hello from Flask</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
var sounds = {{ lesson['sounds']|safe }};
var choices = {{ lesson['choices']|safe }};

function evaluate_answer() {
    var user_answer = $("input[name='answer']:checked").attr("value");
    var correct_answer = $("source").attr("chord");

    console.log(user_answer, correct_answer);

    if (user_answer == correct_answer) {
        $("#response").html("Yup!");
    } else {
        $("#response").html("Nope! Try again.");
    }

    return false;
}

function next_chord() {
    //clear all radio buttons
    $("input:radio").attr("checked", false);

    //clear the answer field
    $("#response").html("");

    var random_idx = Math.floor(Math.random() * sounds.length);

    var sound_and_chord = sounds[random_idx];
    var sound = sound_and_chord[0];
    var chord = sound_and_chord[1];

    var audio_html = '<audio id="player" controls="controls"><source chord="'+chord+'" src="'+sound+'" /></audio>';
    console.log(audio_html);
    $("#asound").html(audio_html);
}

$(function() {
    $("#answerbutton").click(evaluate_answer);
    $("#nextchord").click(next_chord);

    $.each(choices.reverse(), function (idx, val) {
        var display_name = val[0];
        var sound_id = val[1];

        var option_html = '<input type="radio" name="answer" id="'+sound_id+'" value="'+sound_id+'">'+display_name+'</input><br>'

        $("#answerform").prepend(option_html);
    });

    next_chord();
});
    </script>
</head>
<body>
<div id="quiz">
    <div id="asound">
    </div>
    <div id="answers">
        <form id="answerform">
            <input type="submit" name="submit" value="Answer" id="answerbutton" />
        </form>
    </div>
    <div id="response">
    </div>
    <div id="next">
        <a href="#" id="nextchord">Give Me a New Chord</a>
    </div>
</div>
</body>
</html>
